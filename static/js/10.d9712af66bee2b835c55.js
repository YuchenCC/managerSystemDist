webpackJsonp([10,23,54],{1064:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{visible:e.visible,"before-close":e.beforeClose,"append-to-body":!1,"modal-append-to-body":!1,title:"选择人员",width:"800px"},on:{"update:visible":function(t){e.visible=t}}},[a("div",{staticClass:"role_dialog df pb20"},[a("div",[a("div",{staticClass:"mb5",staticStyle:{"font-size":"16px"}},[e._v("部门树")]),e._v(" "),a("div",{staticClass:"p15 w300 bl bt br bb of"},[a("el-row",[a("el-col",{attrs:{span:20}},[a("Tree",{attrs:{reload:e.reloadTree,propData:!0,propTree:this.treeData},on:{callback:e.treeCallback,finishReload:e.finishReload}})],1)],1)],1)]),e._v(" "),a("div",{staticClass:"select_dialog"},[a("div",[a("div",{staticClass:"mb5",staticStyle:{"font-size":"16px"}},[e._v("部门人员")]),e._v(" "),a("div",{staticClass:"p15 w300 bl bt br bb of"},[a("el-row",[e.staffList.length?a("el-col",{staticClass:"ml10 mr10 mt10 mb10",attrs:{span:20}},[a("el-checkbox",{attrs:{disabled:!e.totalLimit,indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v(e._s(e.departmentInfo.department_name))]),e._v(" "),a("div",{staticClass:"mt10 mb10"}),e._v(" "),a("el-checkbox-group",{staticClass:"ml10",attrs:{min:e.limitLength.min,max:e.totalLimit},on:{change:e.handleCheckedDepartmentStaffChange},model:{value:e.checkedEmployees,callback:function(t){e.checkedEmployees=t},expression:"checkedEmployees"}},e._l(e.staffList,function(t){return a("el-checkbox",{key:t.id,attrs:{label:t}},[e._v(e._s(t.staff_name))])}))],1):e._e()],1)],1)]),e._v(" "),a("div",[a("div",{staticClass:"mb5",staticStyle:{"font-size":"16px"}},[e._v("已选人员")]),e._v(" "),a("div",{staticClass:"p15 w300 bl bt br bb of"},[a("el-row",[a("el-col",{staticClass:"ml10 mr10 mt10 mb10",attrs:{span:20}},[a("el-checkbox-group",{staticClass:"ml10",attrs:{min:e.limitLength.min,max:e.limitLength.max},on:{change:e.handleCheckedDepartmentStaffChange},model:{value:e.checkedEmployees,callback:function(t){e.checkedEmployees=t},expression:"checkedEmployees"}},e._l(e.checkedEmployees,function(t){return a("el-checkbox",{key:t.id,attrs:{label:t}},[e._v(e._s(t.staff_name))])}))],1)],1)],1)])])]),e._v(" "),a("div",{staticClass:"dialog-footer mt10",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.closeDialog("save")}}},[e._v("保 存")]),e._v(" "),a("el-button",{on:{click:function(t){e.closeDialog("close")}}},[e._v("取 消")])],1)])],1)},staticRenderFns:[]}},1071:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(219),o=i(n),s=a(933),r=a(871),l=i(r);t.default={name:"Dialog",props:["dialogFormVisible","formData"],components:{RoleSelect:l.default},computed:{visible:{get:function(){return this.dialogFormVisible},set:function(){}},rules:function(){return s.operateDepartment.rules}},data:function(){return{assetLimit:1,assetDialogShow:!1,managerDialogShow:!1,form:this.cloneObjectKeys(this.formData),dutyManagers:""}},methods:{cloneObjectKeys:function(e){var t={};return(0,o.default)(e).map(function(a){return t[a]=e[a]}),t},deleteManager:function(e,t){console.log(e),console.log(this.form)},closeDialog:function(e){this.$emit("closeDialog",this.form,e)},showManagerSelect:function(){this.managerDialogShow=!0},showAssetSelect:function(){this.assetDialogShow=!0},closeAssetDialog:function(e){e&&e.length&&(this.form.asset_manager_name=e[0].staff_name||"",this.form.asset_manager_id=e[0].id||""),this.assetDialogShow=!1},closeManagerDialog:function(e){if(e&&e.length){var t=[],a=[];e.forEach(function(e){var i={};i.duty_manager_id=e.id,i.duty_manager_name=e.staff_name,t.push(i),a.push(i.duty_manager_name)}),this.form.duty_manager_list=t,this.dutyManagers=a.join("、")}this.managerDialogShow=!1},beforeClose:function(e){e(),this.$emit("closeDialog",{},"close")}},watch:{formData:function(){this.form=this.cloneObjectKeys(this.formData)}}}},1103:function(e,t,a){t=e.exports=a(867)(),t.push([e.i,".dialog_input_custom>input{height:28px;font-size:12px;top:1px;position:relative}.dialog_date_custom .el-input__prefix{top:-6px}","",{version:3,sources:["D:/桌面/personal/project/web-project/src/views/organization/department/EditDialog.vue"],names:[],mappings:"AACA,2BACE,YAAa,AACb,eAAgB,AAChB,QAAS,AACT,iBAAmB,CACpB,AACD,sCACE,QAAU,CACX",file:"EditDialog.vue",sourcesContent:["\n.dialog_input_custom > input {\n  height: 28px;\n  font-size: 12px;\n  top: 1px;\n  position: relative;\n}\n.dialog_date_custom .el-input__prefix {\n  top: -6px;\n}\n"],sourceRoot:""}])},1119:function(e,t,a){var i=a(1103);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a(868)("1cea5426",i,!0)},1139:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{visible:e.visible,"modal-append-to-body":!1,"before-close":e.beforeClose,title:"编辑部门",width:"500px"},on:{"update:visible":function(t){e.visible=t}}},[a("div",{staticClass:"p15"},[a("el-form",{ref:"form",staticClass:"form-text f13 ",attrs:{"show-message":!0,"inline-message":!0,model:e.form,rules:e.rules,"label-width":"108px",size:"mini"}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"部门名称：",prop:"department_name"}},[a("el-input",{attrs:{placeholder:"请输入部门名称"},model:{value:e.form.department_name,callback:function(t){e.$set(e.form,"department_name",t)},expression:"form.department_name"}})],1)],1)],1),e._v(" "),a("el-row",{staticClass:"mt5"},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"部门编码：",prop:"department_code"}},[a("el-input",{attrs:{placeholder:"请输入部门编码"},model:{value:e.form.department_code,callback:function(t){e.$set(e.form,"department_code",t)},expression:"form.department_code"}})],1)],1)],1),e._v(" "),a("el-row",{staticClass:"mt5"},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"上级部门：",prop:"parent_dept_id"}},[a("el-input",{attrs:{placeholder:"请输入上级部门"},model:{value:e.form.parent_dept_name,callback:function(t){e.$set(e.form,"parent_dept_name",t)},expression:"form.parent_dept_name"}})],1)],1)],1),e._v(" "),a("el-row",{staticClass:"mt5"},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"部门负责人："}},[a("el-input",{attrs:{placeholder:"请选择部门负责人",readonly:""},nativeOn:{click:function(t){e.showManagerSelect(t)}},model:{value:e.dutyManagers,callback:function(t){e.dutyManagers=t},expression:"dutyManagers"}})],1)],1)],1),e._v(" "),a("el-row",{staticStyle:{"margin-top":"11px"}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"资产管理人：",prop:"asset_manager_name"}},[a("el-input",{attrs:{placeholder:"请选择资产管理人",readonly:""},nativeOn:{click:function(t){e.showAssetSelect(t)}},model:{value:e.form.asset_manager_name,callback:function(t){e.$set(e.form,"asset_manager_name",t)},expression:"form.asset_manager_name"}})],1)],1)],1),e._v(" "),a("el-row",{staticClass:"mt5"},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"状态："}},[a("el-radio-group",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-radio",{attrs:{label:1}},[e._v("启用")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("禁用")])],1)],1)],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer mt10",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.closeDialog("save")}}},[e._v("保 存")]),e._v(" "),a("el-button",{on:{click:function(t){e.closeDialog("close")}}},[e._v("取 消")])],1)]),e._v(" "),a("RoleSelect",{attrs:{dialogFormVisible:e.managerDialogShow},on:{closeDialog:e.closeManagerDialog}}),e._v(" "),a("RoleSelect",{attrs:{dialogFormVisible:e.assetDialogShow,limit:e.assetLimit},on:{closeDialog:e.closeAssetDialog}})],1)},staticRenderFns:[]}},869:function(e,t,a){var i=a(215)(a(931),a(932),null,null);e.exports=i.exports},871:function(e,t,a){a(944);var i=a(215)(a(942),a(1064),"data-v-6067c4a3",null);e.exports=i.exports},875:function(e,t,a){a(1119);var i=a(215)(a(1071),a(1139),null,null);e.exports=i.exports},931:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(369),n=function(e){return e&&e.__esModule?e:{default:e}}(i),o=a(370);t.default={name:"Tree",computed:{tree:function(){return this.propData?this.propTree||[]:this.departmentTree()}},props:["reload","filter","propTree","propData","checkbox"],data:function(){return{defaultProps:{children:"child_list",label:"department_name"},selectDepartment:"",clickNode:{},expandKey:[],nodeLayer:0,filterText:""}},methods:(0,n.default)({},(0,o.mapActions)(["getDepartmentTree"]),(0,o.mapGetters)(["departmentTree"]),{initData:function(){var e=this;if(this.propData){if(this.tree[0]&&this.tree[0].department_id){var t=this.tree[0].department_id;this.$refs.tree.setCurrentKey(t,!0),this.selectDepartment=this.tree[0],this._callback(t)}}else this.getDepartmentTree().then(function(){if(e.tree[0]&&e.tree[0].department_id){var t=e.tree[0].department_id;e.$refs.tree.setCurrentKey(t,!0),e.selectDepartment=e.tree[0],e._callback(t)}})},reloadData:function(){var e=this;if(this.selectDepartment&&this.selectDepartment.department_id){var t=this.selectDepartment.department_id;this.getDepartmentTree().then(function(){e.$refs.tree.setCurrentKey(t,!0)}),this._callback(t,this.selectDepartment)}else this.initData()},treeClick:function(e,t){this.clickNode===t&&this.selectDepartment===e.id||(this.selectDepartment=e,this.clickNode=t,this.nodeLayer=t.level,this.getExpand(t,!0),this._callback(this.selectDepartment.department_id,e))},handleCheckChange:function(){},getExpand:function(e,t){t&&(this.expandKey=[]),e.isLeaf?this.getExpand(e.parent):this.expandKey.push(e.key)},filterNode:function(e,t){return!e||-1!==t.department_name.indexOf(e)},_callback:function(e,t){this.$emit("callback",{id:e,nodeLayer:this.nodeLayer,selectDepartment:this.selectDepartment,_data:t})}}),mounted:function(){this.initData()},watch:{reload:function(){this.reload.reload&&(this.reload.init&&(this.selectDepartment={}),this.reloadData(),this.$emit("finishReload"))},filterText:function(e){this.$refs.tree.filter(e)},propTree:function(){this.initData()}}}},932:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.filter?a("div",{staticClass:"searchInput"},[a("el-input",{attrs:{placeholder:"搜索"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1):e._e(),e._v(" "),a("el-tree",{ref:"tree",attrs:{data:e.tree,props:e.defaultProps,"node-key":"department_id","default-expanded-keys":e.expandKey,"filter-node-method":e.filterNode,"show-checkbox":e.checkbox||!1},on:{"node-click":e.treeClick,"check-change":e.handleCheckChange}})],1)},staticRenderFns:[]}},933:function(e,t,a){"use strict";function i(e,t,a){var i=Number(t);isNaN(i)?a(new Error("日期必选")):a()}function n(e,t,a){11!==t.length?a(new Error("输入11位手机号")):a()}function o(e,t,a){var i=Number(t);isNaN(i)?a(new Error("必须为纯数字")):a()}function s(e,t,a){min&&(t?t.toString().length!==min&&a(new Error("限制"+min+"位")):a())}function r(){return{customer_id:"",customer_name:"customer_name",social_credit_code:"123456789123456789",contact_name:"contact_name",industry_type_id:"industry_type_id",industry_subtype_id:"industry_subtype_id",province_id:"110000",city_id:"110100",admin_id:"",admin_phone:"15880152020",admin_password:"123456",power_customer_no:"",water_customer_no:"",gas_customer_no:"",comm_customer_no:"",business_licence_img:"",start_time:"",end_time:"",enabled_services:["1"],enabled_industries:["1"]}}function l(e,t,a){var i=t.length;i<6||i>8?a(new Error("输入6-8位密码")):a()}function c(e,t,a){t?20!=t.toString().length&&a(new Error("输入18位编号")):a()}function d(){return{customer_name:[{required:!0,message:"必填字段"},{min:2,max:50,message:"长度在 2 到 50 个字符"}],social_credit_code:[{required:!0,message:"必填字段"},{min:18,max:18,message:"长度为18位",trigger:"blur"}],contact_name:[{required:!0,message:"必填字段"},{min:2,max:20,message:"长度在 2 到 20 个字符"}],industry_type_id:[{required:!0,message:"必填字段"}],industry_subtype_id:[{required:!0,message:"必填字段"}],province_id:[],city_id:[],admin_phone:[{required:!0,message:"必填字段"}],admin_password:[{required:!0,message:"必填字段"},{validator:l,trigger:"blur"}],power_customer_no:[{validator:c,trigger:"blur"}],water_customer_no:[{validator:c,trigger:"blur"}],gas_customer_no:[{validator:c,trigger:"blur"}],comm_customer_no:[{validator:c,trigger:"blur"}]}}Object.defineProperty(t,"__esModule",{value:!0}),t.editEmployees=t.operateEmployees=t.operateDepartment=void 0;var m=a(216),u=function(e){return e&&e.__esModule?e:{default:e}}(m);t.initService=r,t.initRule=d;var f={phone:function(){return[{required:!0,message:"手机号必填"},{validator:n,trigger:"blur"},{validator:o}]},required:function(e){return[{required:!0,message:e,trigger:"blur"}]},length:function(e,t){return t?[{min:e,max:t,message:"位数限制，请输入"+e+"-"+t+"位"}]:[{validator:s,trigger:"blur"}]},email:function(){return[{type:"email",message:"请填写正确邮箱格式"}]},date:function(){return[{required:!0,message:"日期必填"},{validator:i}]}};t.operateDepartment={rules:{department_name:f.required("部门名称必填")},init:function(){return{asset_manager_id:"",department_code:"",department_name:"",duty_manager_ids:[],parent_dept_id:"",status:1}}},t.operateEmployees={rules:{staff_name:f.required("姓名必填"),job_no:f.length(2,10),phone:f.phone(),password:[].concat((0,u.default)(f.required("密码必填")),(0,u.default)(f.length(6,10))),email:[].concat((0,u.default)(f.required("邮箱必填")),(0,u.default)(f.email())),birth_date:f.date(),join_date:f.date()},init:function(){return{birth_date:"",department_id:"",department_name:"",email:"",enterprise_id:"",enterprise_name:"",enterprise_type:"",job_no:"",join_date:"",office_phoneFront:"",office_phoneEnd:"",password:"",phone:"",remark:"",duty:"",sex:1,staff_name:"",status:1,wechat_no:""}}},t.editEmployees={rules:{staff_name:f.required("姓名必填"),job_no:f.length(2,10),phone:f.phone(),email:[].concat((0,u.default)(f.required("邮箱必填")),(0,u.default)(f.email())),birth_date:f.date(),join_date:f.date()},init:function(){return{birth_date:"",department_id:"",department_name:"",email:"",enterprise_id:"",enterprise_name:"",enterprise_type:"",job_no:"",join_date:"",office_phoneFront:"",office_phoneEnd:"",phone:"",remark:"",duty:"",sex:1,staff_name:"",status:1,wechat_no:""}}}},942:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(216),o=i(n),s=a(369),r=i(s),l=a(869),c=i(l),d=a(370);t.default={name:"Dialog",components:{Tree:c.default},props:["dialogFormVisible","limit"],computed:{visible:{get:function(){return this.dialogFormVisible},set:function(){}},treeData:function(){return this.staffTree()},limitLength:function(){var e={min:0,max:9999};return console.log(e),this.limit&&(this.limit instanceof Array?(e.min=Number(this.limit[0])||0,e.max=Number(this.limit[1])||9999):e.max=Number(this.limit)||9999),e}},data:function(){return{totalLimit:9999,checkAll:!1,showModal:!1,reloadTree:!1,treeBackData:{},departmentInfo:{},staffList:[],checkedEmployees:[],isIndeterminate:!0}},mounted:function(){this.initTree()},methods:(0,r.default)({},(0,d.mapActions)(["getStaffTree"]),(0,d.mapGetters)(["staffTree"]),{closeDialog:function(e){this.$emit("closeDialog",this.checkedEmployees),"close"!==e&&(this.reloadTree=!0)},dataHandler:function(e){this.departmentInfo={department_id:e.department_id||"",department_name:e.department_name||""},this.staffList=[].concat((0,o.default)(e.staff_list||[]))},modalShow:function(){this.showModal=!0},closeModal:function(e){this.form.department=e},beforeClose:function(e){e(),this.$emit("closeDialog")},finishReload:function(){this.reloadTree=!1},treeCallback:function(e){e._data&&this.dataHandler(e._data)},initTree:function(){this.getStaffTree()},handleCheckAllChange:function(e){var t=this;if(e){var a=[];this.staffList.forEach(function(e){var i=1;t.checkedEmployees.length&&t.checkedEmployees.forEach(function(t){e.id===t.id&&(i=0)}),i&&a.push(e)}),this.checkedEmployees=[].concat((0,o.default)(this.checkedEmployees),a)}else this.staffList.forEach(function(e){var a=null;t.checkedEmployees.length&&t.checkedEmployees.forEach(function(t,i){e.id===t.id&&(a=i)}),(a||0===a)&&t.checkedEmployees.splice(a,1)});this.isIndeterminate=!1},handleCheckedDepartmentStaffChange:function(e){this.computedCheck(e)},computedCheck:function(e){var t=this,a=e||this.checkedEmployees,i=0;a.length&&a.forEach(function(e){t.staffList.length&&t.staffList.forEach(function(t){t.id===e.id&&(i+=1)})}),this.checkAll=i===this.staffList.length,this.isIndeterminate=i>0&&i<this.staffList.length}}),watch:{staffList:function(){0===this.staffList.length?(this.checkAll=!1,this.isIndeterminate=!0):this.computedCheck()},checkedEmployees:function(){console.log(this.checkedEmployees);var e=this.checkedEmployees.length;console.log(this.limitLength);var t=this.limitLength.max;this.totalLimit=t-e,console.log(this.totalLimit)}}}},943:function(e,t,a){t=e.exports=a(867)(),t.push([e.i,".role_dialog[data-v-6067c4a3]{justify-content:space-around;height:360px}.of[data-v-6067c4a3]{height:100%;overflow:auto}.select_dialog[data-v-6067c4a3]{display:flex;justify-content:space-between;flex-direction:column}.select_dialog>div[data-v-6067c4a3]{height:150px}","",{version:3,sources:["D:/桌面/personal/project/web-project/src/views/organization/common/RoleSelect.vue"],names:[],mappings:"AACA,8BACE,6BAA8B,AAC9B,YAAc,CACf,AACD,qBACE,YAAa,AACb,aAAe,CAChB,AACD,gCACE,aAAc,AACd,8BAA+B,AAC/B,qBAAuB,CACxB,AACD,oCACI,YAAc,CACjB",file:"RoleSelect.vue",sourcesContent:["\n.role_dialog[data-v-6067c4a3] {\n  justify-content: space-around;\n  height: 360px;\n}\n.of[data-v-6067c4a3] {\n  height: 100%;\n  overflow: auto;\n}\n.select_dialog[data-v-6067c4a3] {\n  display: flex;\n  justify-content: space-between;\n  flex-direction: column;\n}\n.select_dialog > div[data-v-6067c4a3] {\n    height: 150px;\n}\n"],sourceRoot:""}])},944:function(e,t,a){var i=a(943);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a(868)("36ef5677",i,!0)}});
//# sourceMappingURL=10.d9712af66bee2b835c55.js.map