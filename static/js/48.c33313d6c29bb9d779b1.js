webpackJsonp([48],{1182:function(t,e,a){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=a(218),i=s(r),n=a(217),l=s(n),o=a(142),u=s(o),c=a(928),m=s(c);e.default={data:function(){return{query:{customer_name:"",project_name:"",visit_purpose:""}}},mixins:[m.default],methods:{_loadList:function(){function t(){return e.apply(this,arguments)}var e=(0,l.default)(i.default.mark(function t(){var e,a;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this,t.next=3,u.default.visit.getVisitRecord(e.assignQuery(e.query));case 3:a=t.sent,e.initialTableData(a.rows,a.total);case 5:case"end":return t.stop()}},t,this)}));return t}(),toDetail:function(t){this.$router.push({name:"visitDetail",params:{visitId:t.id}})},toEdit:function(t){this.$router.push({name:"visitEdit",params:{visitId:t.id}})},toDel:function(){function t(t){return e.apply(this,arguments)}var e=(0,l.default)(i.default.mark(function t(e){var a;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.default.visit.visitDel();case 2:a=t.sent;case 3:case"end":return t.stop()}},t,this)}));return t}(),toNewVist:function(){this.$router.push({name:"visitNew"})}}}},1261:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"visit-list"},[a("el-form",{ref:"searchForm",staticClass:"mt20",attrs:{inline:!0,model:t.query,size:"small"}},[a("el-form-item",{staticClass:"mb0",attrs:{label:"拜访客户:",prop:"customer_name"}},[a("el-input",{model:{value:t.query.customer_name,callback:function(e){t.$set(t.query,"customer_name",e)},expression:"query.customer_name"}})],1),t._v(" "),a("el-form-item",{staticClass:"mb0",attrs:{label:"所属项目:",prop:"project_name"}},[a("el-input",{model:{value:t.query.project_name,callback:function(e){t.$set(t.query,"project_name",e)},expression:"query.project_name"}})],1),t._v(" "),a("el-form-item",{staticClass:"mb0",attrs:{label:"拜访目的:",prop:"visit_purpose"}},[a("el-input",{model:{value:t.query.visit_purpose,callback:function(e){t.$set(t.query,"visit_purpose",e)},expression:"query.visit_purpose"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.onSearch}},[t._v("查询")]),t._v(" "),a("el-button",{on:{click:t.onReset}},[t._v("清空")])],1)],1),t._v(" "),a("div",{staticClass:"mb20"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.toNewVist}},[t._v("新增拜访记录")])],1),t._v(" "),a("el-table",{attrs:{data:t.tableParams.list,"header-align":"center",border:"","header-row-class-name":"header-center"}},[a("el-table-column",{attrs:{label:"客户名称",prop:"customer_name"}}),t._v(" "),a("el-table-column",{attrs:{label:"所属项目",prop:"project_name"}}),t._v(" "),a("el-table-column",{attrs:{label:"拜访对象",prop:"customer_linkman_name"}}),t._v(" "),a("el-table-column",{attrs:{label:"推动计划",prop:"promote"}}),t._v(" "),a("el-table-column",{attrs:{label:"拜访人",prop:"creator_name"}}),t._v(" "),a("el-table-column",{attrs:{label:"拜访时间",prop:"visit_time"}}),t._v(" "),a("el-table-column",{staticClass:"tc",attrs:{label:"操作",fixed:"right",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"mini"},nativeOn:{click:function(a){t.toDetail(e.row)}}},[t._v("查看")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini"},nativeOn:{click:function(a){t.toEdit(e.row)}}},[t._v("\n\t\t\t\t\t\t编辑")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini"},nativeOn:{click:function(e){t.toDel(t.scop.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),t.tableParams.totalCount?a("el-pagination",{staticClass:"mt15",attrs:{"current-page":t.tableParams.currentPage,"page-sizes":t.tableParams.pageSizeList,"page-size":t.tableParams.pageSize,layout:t.tableParams.layout,total:t.tableParams.totalCount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}):t._e()],1)},staticRenderFns:[]}},925:function(t,e,a){var s=a(215)(a(1182),a(1261),null,null);t.exports=s.exports},928:function(t,e,a){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=a(216),i=s(r),n=a(369),l=s(n);e.default={data:function(){return{tableServer:{},tableDataList:[],tableSelectionItems:[],tableTotalCount:0,tableOption:{layout:"total, sizes, prev, pager, next, jumper",pageSizeList:[10,20,30,40]},tableParams:{page_size:10,page_num:1}}},mounted:function(){var t=this;this.initTableServer&&this.initTableServer().then(function(){t.requestData()})},computed:{selectedIds:function(){var t=this;return this.tableParams.selectedItems.map(function(e){return e[t.pk]})}},methods:{requestData:function(){var t=this;this.tableServer.loadTableData&&this.tableServer.extraParams.id&&this.tableServer.loadTableData(this.paramsHandler()).then(function(){t.initialTableData(t.tableServer.dataList())})},paramsHandler:function(){return(0,l.default)({},this.tableParams,this.tableServer.extraParams,this.tableServer.searchParams)},initialTableData:function(t){this.tableDataList=t.data_list,this.tableTotalCount=t.total_num,this.tableParams.page_size===t.page_size&&this.tableParams.page_num===t.page_num||(this.$message("当前页数不匹配"),console.log(t),this.tableParams.page_size=t.page_size,this.tableParams.page_num=t.page_num)},handleSizeChange:function(t){t&&t!==this.tableParams.page_size&&(this.tableParams.page_size=t,this.requestData())},handleCurrentChange:function(t){t&&this.tableParams.page_num!==t&&(this.tableParams.page_num=t,this.requestData())},onSelectionChange:function(t){this.tableSelectionItems=[].concat((0,i.default)(t))},assignQuery:function(t){return(0,l.default)({page_num:this.tableParams.pageNum,page_size:this.tableParams.pageSize},t)},onSearch:function(){this.tableParams.pageNum=1,this._loadList()}}}}});
//# sourceMappingURL=48.c33313d6c29bb9d779b1.js.map