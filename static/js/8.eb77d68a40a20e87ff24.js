webpackJsonp([8,22,54],{1074:function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=o(219),n=r(a),i=o(369),s=r(i),l=o(870),c=r(l),d=o(933),u=o(370),m=o(1088),p=r(m);t.default={name:"Dialog",components:{DepartmentSelect:c.default},props:["dialogFormVisible","formDataId"],mixins:[(0,p.default)({rules:d.editEmployees.rules})],computed:{visible:{get:function(){return this.dialogFormVisible},set:function(){}}},data:function(){return{departmentDialogShow:!1,roleDict:["部门主管","维护人员","组长","巡检人员"],formData:{}}},methods:(0,s.default)({},(0,u.mapActions)(["getEmployeesInfo","putEmployees"]),{formHandler:function(){var e=this,t={office_phone:[],role_ids:[],role_names:[]};return(0,n.default)(this.form).map(function(o){return"office_phoneFront"===o?t.office_phone[0]=e.form[o]:"office_phoneEnd"===o?t.office_phone[1]=e.form[o]:void("duty"!==o&&(t[o]=e.form[o]))}),t.office_phone=t.office_phone.join("-"),t},closeDialog:function(e){var t=this;this.$refs.end.error&&(this.$refs.end.error=void 0),"close"===e?this.$emit("closeDialog",{close:!0,reload:!1}):this.validateForm().then(function(){var e=t.formHandler();t.putEmployees(e).then(function(){t.$emit("closeDialog",{close:!0,reload:!0})}).catch(function(e){return t.$refs.end.error=e})})},showDepartmentSelect:function(){this.departmentDialogShow=!0},closeDepartmentDialog:function(e){e&&e.department_id&&(this.form.department_id=e.department_id,this.form.department_name=e.department_name),this.departmentDialogShow=!1},beforeClose:function(e){e(),this.$emit("closeDialog")}}),watch:{formDataId:function(){var e=this;this.initForm(),this.getEmployeesInfo(this.formDataId).then(function(t){e.formData=t}).catch(function(){e.$message.error({message:"服务器错误，请重试",showClose:!0,duration:4e3}),e.$emit("closeDialog",{close:!0,reload:!1})})}}}},1088:function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=o(219),n=r(a),i=o(108),s=r(i);t.default=function(e){return{data:function(){return{form:this.cloneObjectKeys(this.formData)}},watch:{formData:function(){this.form=this.cloneObjectKeys(this.formData)}},mounted:function(){this.initForm()},computed:{rules:function(){return e.rules}},methods:{validateForm:function(){var e=this;return new s.default(function(t,o){e.$refs.form.validate(function(e){if(!e)return o();t()})})},initForm:function(){this.$refs.form&&this.$refs.form.resetFields()},cloneObjectKeys:function(e){var t={};if(e){var o=(0,n.default)(e);o.length&&o.forEach(function(o){if("office_phone"===o&&e[o]){var r=e[o].split("-");return t.office_phoneFront=r[0],void(t.office_phoneEnd=r[1])}t[o]=e[o]})}return t}}}}},1104:function(e,t,o){t=e.exports=o(867)(),t.push([e.i,".dialog_input_custom .el-input__suffix{top:-5px}.dialog_input_custom>input{height:28px;font-size:12px;top:1px;position:relative}.dialog_date_custom .el-input__prefix{top:-6px}","",{version:3,sources:["D:/桌面/personal/project/web-project/src/views/organization/employees/EditDialog.vue"],names:[],mappings:"AACA,uCACE,QAAU,CACX,AACD,2BACE,YAAa,AACb,eAAgB,AAChB,QAAS,AACT,iBAAmB,CACpB,AACD,sCACE,QAAU,CACX",file:"EditDialog.vue",sourcesContent:["\n.dialog_input_custom .el-input__suffix {\n  top: -5px;\n}\n.dialog_input_custom > input {\n  height: 28px;\n  font-size: 12px;\n  top: 1px;\n  position: relative;\n}\n.dialog_date_custom .el-input__prefix {\n  top: -6px;\n}\n"],sourceRoot:""}])},1120:function(e,t,o){var r=o(1104);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);o(868)("2ff207e0",r,!0)},1140:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-dialog",{attrs:{visible:e.visible,"before-close":e.beforeClose,"modal-append-to-body":!1,title:"编辑人员",width:"800px"},on:{"update:visible":function(t){e.visible=t}}},[o("div",{staticClass:"p15"},[o("el-form",{ref:"form",staticClass:"form-text f13 ",attrs:{"validate-on-rule-change":!1,"show-message":!0,"inline-message":!0,model:e.form,rules:e.rules,"label-width":"108px",size:"mini"}},[o("el-row",[o("el-col",{attrs:{span:16}},[o("el-form-item",{attrs:{label:"姓名：",prop:"staff_name"}},[o("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.form.staff_name,callback:function(t){e.$set(e.form,"staff_name",t)},expression:"form.staff_name"}})],1)],1)],1),e._v(" "),o("el-row",{staticClass:"mt5"},[o("el-col",{attrs:{span:16}},[o("el-form-item",{attrs:{label:"工号：",prop:"job_no"}},[o("el-input",{attrs:{placeholder:"请输入工号/账号"},model:{value:e.form.job_no,callback:function(t){e.$set(e.form,"job_no",t)},expression:"form.job_no"}})],1)],1)],1),e._v(" "),o("el-row",{staticClass:"mt5"},[o("el-col",{attrs:{span:16}},[o("el-form-item",{attrs:{label:"手机号：",prop:"phone"}},[o("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1)],1)],1),e._v(" "),o("el-row",{staticClass:"mt5"},[o("el-col",{attrs:{span:16}},[o("el-form-item",{attrs:{label:"性别："}},[o("el-radio-group",{model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[o("el-radio",{attrs:{label:1}},[e._v("男")]),e._v(" "),o("el-radio",{attrs:{label:0}},[e._v("女")])],1)],1)],1)],1),e._v(" "),o("el-row",{staticClass:"mt5"},[o("el-col",{attrs:{span:16}},[o("el-form-item",{attrs:{label:"所属部门："}},[o("el-input",{attrs:{placeholder:"请选择部门",readonly:""},nativeOn:{click:function(t){e.showDepartmentSelect(t)}},model:{value:e.form.department_name,callback:function(t){e.$set(e.form,"department_name",t)},expression:"form.department_name"}})],1)],1)],1),e._v(" "),o("el-row",{staticClass:"mt5"},[o("el-col",{staticClass:"dialog_input_custom",attrs:{span:16}},[o("el-form-item",{attrs:{label:"职务："}},[o("el-select",{attrs:{placeholder:"选择职务"},model:{value:e.form.duty,callback:function(t){e.$set(e.form,"duty",t)},expression:"form.duty"}},e._l(e.roleDict,function(e,t){return o("el-option",{key:t,attrs:{label:e,value:t}})}))],1)],1)],1),e._v(" "),o("el-row",{staticClass:"mt5"},[o("el-col",{attrs:{span:16}},[o("el-form-item",{attrs:{label:"邮箱：",prop:"email"}},[o("el-input",{attrs:{placeholder:"请选择所在组织部门",type:"email"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1)],1)],1),e._v(" "),o("el-row",{staticClass:"mt5"},[o("el-col",{attrs:{span:16}},[o("el-row",{attrs:{type:"flex",justify:"space-between"}},[o("el-col",{attrs:{span:19}},[o("el-form-item",{attrs:{label:"办公电话："}},[o("el-input",{attrs:{placeholder:"请选择所在组织部门",type:"email"},model:{value:e.form.office_phoneFront,callback:function(t){e.$set(e.form,"office_phoneFront",t)},expression:"form.office_phoneFront"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:4}},[o("el-input",{staticClass:"dialog_input_custom",attrs:{placeholder:"分机"},model:{value:e.form.office_phoneEnd,callback:function(t){e.$set(e.form,"office_phoneEnd",t)},expression:"form.office_phoneEnd"}})],1)],1)],1)],1),e._v(" "),o("el-row",{staticClass:"mt5"},[o("el-col",{attrs:{span:16}},[o("el-form-item",{attrs:{label:"微信号："}},[o("el-input",{attrs:{placeholder:"请输入微信号"},model:{value:e.form.wechat_no,callback:function(t){e.$set(e.form,"wechat_no",t)},expression:"form.wechat_no"}})],1)],1)],1),e._v(" "),o("el-row",{staticClass:"mt5"},[o("el-col",{staticClass:"dialog_input_custom",attrs:{span:16}},[o("el-form-item",{attrs:{label:"出生日期：",prop:"birth_date"}},[o("el-date-picker",{staticClass:"dialog_date_custom",attrs:{id:"born",type:"date",placeholder:"请选择出生年月日","value-format":"timestamp"},model:{value:e.form.birth_date,callback:function(t){e.$set(e.form,"birth_date",t)},expression:"form.birth_date"}})],1)],1)],1),e._v(" "),o("el-row",{staticClass:"mt5"},[o("el-col",{staticClass:"dialog_input_custom",attrs:{span:16}},[o("el-form-item",{attrs:{label:"入职时间：",prop:"join_date"}},[o("el-date-picker",{staticClass:"dialog_date_custom",attrs:{id:"date",type:"date",placeholder:"请选择毕业时间","value-format":"timestamp"},model:{value:e.form.join_date,callback:function(t){e.$set(e.form,"join_date",t)},expression:"form.join_date"}})],1)],1)],1),e._v(" "),o("el-row",{staticClass:"mt5"},[o("el-col",{attrs:{span:16}},[o("el-form-item",{attrs:{label:"用户状态："}},[o("el-radio-group",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[o("el-radio",{attrs:{label:1}},[e._v("启用")]),e._v(" "),o("el-radio",{attrs:{label:0}},[e._v("禁用")])],1)],1)],1)],1),e._v(" "),o("el-row",[o("el-col",{attrs:{span:24}},[o("el-form-item",{ref:"end",attrs:{label:"备注："}},[o("el-input",{attrs:{type:"textarea",rows:4},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1)],1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer mt10",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.closeDialog("save")}}},[e._v("保 存")]),e._v(" "),o("el-button",{on:{click:function(t){e.closeDialog("close")}}},[e._v("取 消")])],1)]),e._v(" "),o("DepartmentSelect",{attrs:{dialogFormVisible:e.departmentDialogShow},on:{closeDialog:e.closeDepartmentDialog}})],1)},staticRenderFns:[]}},869:function(e,t,o){var r=o(215)(o(931),o(932),null,null);e.exports=r.exports},870:function(e,t,o){o(938);var r=o(215)(o(936),o(941),null,null);e.exports=r.exports},878:function(e,t,o){o(1120);var r=o(215)(o(1074),o(1140),null,null);e.exports=r.exports},931:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(369),a=function(e){return e&&e.__esModule?e:{default:e}}(r),n=o(370);t.default={name:"Tree",computed:{tree:function(){return this.propData?this.propTree||[]:this.departmentTree()}},props:["reload","filter","propTree","propData","checkbox"],data:function(){return{defaultProps:{children:"child_list",label:"department_name"},selectDepartment:"",clickNode:{},expandKey:[],nodeLayer:0,filterText:""}},methods:(0,a.default)({},(0,n.mapActions)(["getDepartmentTree"]),(0,n.mapGetters)(["departmentTree"]),{initData:function(){var e=this;if(this.propData){if(this.tree[0]&&this.tree[0].department_id){var t=this.tree[0].department_id;this.$refs.tree.setCurrentKey(t,!0),this.selectDepartment=this.tree[0],this._callback(t)}}else this.getDepartmentTree().then(function(){if(e.tree[0]&&e.tree[0].department_id){var t=e.tree[0].department_id;e.$refs.tree.setCurrentKey(t,!0),e.selectDepartment=e.tree[0],e._callback(t)}})},reloadData:function(){var e=this;if(this.selectDepartment&&this.selectDepartment.department_id){var t=this.selectDepartment.department_id;this.getDepartmentTree().then(function(){e.$refs.tree.setCurrentKey(t,!0)}),this._callback(t,this.selectDepartment)}else this.initData()},treeClick:function(e,t){this.clickNode===t&&this.selectDepartment===e.id||(this.selectDepartment=e,this.clickNode=t,this.nodeLayer=t.level,this.getExpand(t,!0),this._callback(this.selectDepartment.department_id,e))},handleCheckChange:function(){},getExpand:function(e,t){t&&(this.expandKey=[]),e.isLeaf?this.getExpand(e.parent):this.expandKey.push(e.key)},filterNode:function(e,t){return!e||-1!==t.department_name.indexOf(e)},_callback:function(e,t){this.$emit("callback",{id:e,nodeLayer:this.nodeLayer,selectDepartment:this.selectDepartment,_data:t})}}),mounted:function(){this.initData()},watch:{reload:function(){this.reload.reload&&(this.reload.init&&(this.selectDepartment={}),this.reloadData(),this.$emit("finishReload"))},filterText:function(e){this.$refs.tree.filter(e)},propTree:function(){this.initData()}}}},932:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[e.filter?o("div",{staticClass:"searchInput"},[o("el-input",{attrs:{placeholder:"搜索"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}},[o("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1):e._e(),e._v(" "),o("el-tree",{ref:"tree",attrs:{data:e.tree,props:e.defaultProps,"node-key":"department_id","default-expanded-keys":e.expandKey,"filter-node-method":e.filterNode,"show-checkbox":e.checkbox||!1},on:{"node-click":e.treeClick,"check-change":e.handleCheckChange}})],1)},staticRenderFns:[]}},933:function(e,t,o){"use strict";function r(e,t,o){var r=Number(t);isNaN(r)?o(new Error("日期必选")):o()}function a(e,t,o){11!==t.length?o(new Error("输入11位手机号")):o()}function n(e,t,o){var r=Number(t);isNaN(r)?o(new Error("必须为纯数字")):o()}function i(e,t,o){min&&(t?t.toString().length!==min&&o(new Error("限制"+min+"位")):o())}function s(){return{customer_id:"",customer_name:"customer_name",social_credit_code:"123456789123456789",contact_name:"contact_name",industry_type_id:"industry_type_id",industry_subtype_id:"industry_subtype_id",province_id:"110000",city_id:"110100",admin_id:"",admin_phone:"15880152020",admin_password:"123456",power_customer_no:"",water_customer_no:"",gas_customer_no:"",comm_customer_no:"",business_licence_img:"",start_time:"",end_time:"",enabled_services:["1"],enabled_industries:["1"]}}function l(e,t,o){var r=t.length;r<6||r>8?o(new Error("输入6-8位密码")):o()}function c(e,t,o){t?20!=t.toString().length&&o(new Error("输入18位编号")):o()}function d(){return{customer_name:[{required:!0,message:"必填字段"},{min:2,max:50,message:"长度在 2 到 50 个字符"}],social_credit_code:[{required:!0,message:"必填字段"},{min:18,max:18,message:"长度为18位",trigger:"blur"}],contact_name:[{required:!0,message:"必填字段"},{min:2,max:20,message:"长度在 2 到 20 个字符"}],industry_type_id:[{required:!0,message:"必填字段"}],industry_subtype_id:[{required:!0,message:"必填字段"}],province_id:[],city_id:[],admin_phone:[{required:!0,message:"必填字段"}],admin_password:[{required:!0,message:"必填字段"},{validator:l,trigger:"blur"}],power_customer_no:[{validator:c,trigger:"blur"}],water_customer_no:[{validator:c,trigger:"blur"}],gas_customer_no:[{validator:c,trigger:"blur"}],comm_customer_no:[{validator:c,trigger:"blur"}]}}Object.defineProperty(t,"__esModule",{value:!0}),t.editEmployees=t.operateEmployees=t.operateDepartment=void 0;var u=o(216),m=function(e){return e&&e.__esModule?e:{default:e}}(u);t.initService=s,t.initRule=d;var p={phone:function(){return[{required:!0,message:"手机号必填"},{validator:a,trigger:"blur"},{validator:n}]},required:function(e){return[{required:!0,message:e,trigger:"blur"}]},length:function(e,t){return t?[{min:e,max:t,message:"位数限制，请输入"+e+"-"+t+"位"}]:[{validator:i,trigger:"blur"}]},email:function(){return[{type:"email",message:"请填写正确邮箱格式"}]},date:function(){return[{required:!0,message:"日期必填"},{validator:r}]}};t.operateDepartment={rules:{department_name:p.required("部门名称必填")},init:function(){return{asset_manager_id:"",department_code:"",department_name:"",duty_manager_ids:[],parent_dept_id:"",status:1}}},t.operateEmployees={rules:{staff_name:p.required("姓名必填"),job_no:p.length(2,10),phone:p.phone(),password:[].concat((0,m.default)(p.required("密码必填")),(0,m.default)(p.length(6,10))),email:[].concat((0,m.default)(p.required("邮箱必填")),(0,m.default)(p.email())),birth_date:p.date(),join_date:p.date()},init:function(){return{birth_date:"",department_id:"",department_name:"",email:"",enterprise_id:"",enterprise_name:"",enterprise_type:"",job_no:"",join_date:"",office_phoneFront:"",office_phoneEnd:"",password:"",phone:"",remark:"",duty:"",sex:1,staff_name:"",status:1,wechat_no:""}}},t.editEmployees={rules:{staff_name:p.required("姓名必填"),job_no:p.length(2,10),phone:p.phone(),email:[].concat((0,m.default)(p.required("邮箱必填")),(0,m.default)(p.email())),birth_date:p.date(),join_date:p.date()},init:function(){return{birth_date:"",department_id:"",department_name:"",email:"",enterprise_id:"",enterprise_name:"",enterprise_type:"",job_no:"",join_date:"",office_phoneFront:"",office_phoneEnd:"",phone:"",remark:"",duty:"",sex:1,staff_name:"",status:1,wechat_no:""}}}},936:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(869),a=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default={name:"Dialog",components:{Tree:a.default},props:["dialogFormVisible"],computed:{visible:{get:function(){return this.dialogFormVisible},set:function(){}}},data:function(){return{showModal:!1,reloadTree:!1,treeBackData:{}}},mounted:function(){},methods:{closeDialog:function(e){this.$emit("closeDialog",this.treeBackData),"close"!==e&&(this.reloadTree=!0)},modalShow:function(){this.showModal=!0},closeModal:function(e){this.form.department=e},beforeClose:function(e){e(),this.$emit("closeDialog")},finishReload:function(){this.reloadTree=!1},treeCallback:function(e){console.log("treeCallback"),console.log(e),e.selectDepartment&&(this.treeBackData=e.selectDepartment)}}}},937:function(e,t,o){t=e.exports=o(867)(),t.push([e.i,".dialog_input_custom>input{height:28px;font-size:12px;top:1px;position:relative}.dialog_date_custom .el-input__prefix{top:-6px}","",{version:3,sources:["D:/桌面/personal/project/web-project/src/views/organization/employees/DepartmentSelect.vue"],names:[],mappings:"AACA,2BACE,YAAa,AACb,eAAgB,AAChB,QAAS,AACT,iBAAmB,CACpB,AACD,sCACE,QAAU,CACX",file:"DepartmentSelect.vue",sourcesContent:["\n.dialog_input_custom > input {\n  height: 28px;\n  font-size: 12px;\n  top: 1px;\n  position: relative;\n}\n.dialog_date_custom .el-input__prefix {\n  top: -6px;\n}\n"],sourceRoot:""}])},938:function(e,t,o){var r=o(937);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);o(868)("d5be57c0",r,!0)},941:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-dialog",{attrs:{visible:e.visible,"before-close":e.beforeClose,"append-to-body":!1,"modal-append-to-body":!1,title:"选择部门",width:"500px"},on:{"update:visible":function(t){e.visible=t}}},[o("div",{staticClass:"p15"},[o("el-row",[o("el-col",{attrs:{span:20}},[o("Tree",{attrs:{reload:e.reloadTree},on:{callback:e.treeCallback,finishReload:e.finishReload}})],1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer mt10",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.closeDialog("save")}}},[e._v("保 存")]),e._v(" "),o("el-button",{on:{click:function(t){e.closeDialog("close")}}},[e._v("取 消")])],1)])],1)},staticRenderFns:[]}}});
//# sourceMappingURL=8.eb77d68a40a20e87ff24.js.map